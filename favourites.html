<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="fav.css">
    <script src="https://kit.fontawesome.com/a90f419642.js" crossorigin="anonymous"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="jquery-ui-1.9.0.custom.min.js"></script>
    <title>Add To Favourites</title>
</head>
<body>
    <header>
        <div class="logo">
            <img src="images/logo.png" alt="logo">
        </div>
        <nav class="nav" id="nav-menu">

            <ul class="nav-list">
                <li class="nav-item"><a href="homepage.html" class="nav-link">HOME</a></li>
                <li class="nav-item"><a href="search.html" class="nav-link">SEARCH</a></li>
                <li class="nav-item" id="fav-btn"><a href="../../favourites.html"><i class="fas fa-heart"></i></a></li>
            </ul>
        </nav>
    </header>

    <section id="product">
        <ul class="clear">
            <li data-id="1">
                <a href="#">
                    <img src="shoe-pages/Pure-Tone/images/1.jpg" class="shoe-img" alt="pure-tone-1">
                    <h3>Pure Tone</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star"></span>
                    </div>

                    <h4 class="product-prize">£75.00</h4>
                    <p id="shoe1-Pure-Tone">
                        <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                        <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>
                </a>
            </li>
            <li data-id="2">
                <a href="#">
                    <img src="shoe-images/DevaMae/1.jpg" class="shoe-img" alt="Deva mae">
            		<h3>Deva Mae</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                    </div>

                    <h4 class="product-prize">£55.00</h4>
                    <p id="shoe6-deva-mae">
                        <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                        <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>
                </a>
            </li>
            <li data-id="3">
                <a href="#">
                    <img src="shoe-images/KaylinCara/1.jpg" class="shoe-img" alt="Kaylin-Cara-1">
            		<h3>Kaylin Cara</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star "></span>
                        <span class="fa fa-star"></span>
                    </div>

                    <h4 class="product-prize">£29.00</h4>
                    <p id="shoe5-Kaylin-cara">
                        <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                        <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>    
                </a>
            </li>
            <li data-id="4">
                <a href="#">
                    <img src="shoe-images/NatureThree/1.jpg" class="shoe-img" alt="Nature Three">
            		<h3>Nature Three</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star"></span>
                    </div>

                    <h4 class="product-prize">£90.00</h4>
                    <p id="shoe3-Nature-Three">
                        <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                        <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>
                </a>
            </li>
            <li data-id="5">
                <a href="#">
                    <img src="shoe-images/Orinoco2Lace/1.jpg" class="shoe-img" alt="Orinoco 2 lace">
                    <h3>Orinoco 2 Lace</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star"></span>
                    </div>

                    <h4 class="product-prize">£89.00</h4>
                    <p id="shoe2-Orinoco-Lace">
                        <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                        <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>    
                </a>
            </li>
            <li data-id="6">
                <a href="#">
                    <img src="shoe-images/PiltonMule/1.jpg" class="shoe-img" alt="Pilton Mule">
            		<h3>Pilton Mule</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star"></span>
                    </div>

                    <h4 class="product-prize">£59.00</h4>
                    <p id="shoe4-Pilton-Mule">
                         <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                         <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>
                </a>
            </li>
            <li data-id="7">
                <a href="#">
                    <img src="shoe-images/SidtonLace/1.jpg" class="shoe-img" alt="sidton Lace">
            		<h3>Sidton Lace</h3>
                    <div class="star-rating" >
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                        <span class="fa fa-star checked"></span>
                    </div>

                    <h4 class="product-prize">£49.00</h4>
                    <p id="shoe7-sidton-lace">
                         <button class="fav-button"><i class="fas fa-heart"></i> Add To Favourites</button><br>
                         <button class="remove-button"><i class="fas fa-heart-broken"></i> Remove Favourites</button>
                    </p>
                </a>
            </li>
        </ul>
  </section>

  <aside id="sidebar">
    <div class="basket">
        <div class="basket_list">
            <div class="head">
                <span class="name">Product Name</span>
            </div>
            <ul></ul>
        </div>
    </div>
</aside>



  <script>
    $(function () {

		// jQuery UI Draggable
		$("#product li").draggable({
		
			// brings the item back to its place when dragging is over
			revert:true,
		
			// once the dragging starts, we decrease the opactiy of other items
			// Appending a class as we do that with CSS
			drag:function () {
				$(this).addClass("active");
				$(this).closest("#product").addClass("active");
			},
		
			// removing the CSS classes once dragging is over.
			stop:function () {
				$(this).removeClass("active").closest("#product").removeClass("active");
			}
		});

        // jQuery Ui Droppable
		$(".basket").droppable({
		
			// The class that will be appended to the to-be-dropped-element (basket)
			activeClass:"active",
		
			// The class that will be appended once we are hovering the to-be-dropped-element (basket)
			hoverClass:"hover",
		
			// The acceptance of the item once it touches the to-be-dropped-element basket
			// For different values http://api.jqueryui.com/droppable/#option-tolerance
			tolerance:"touch",
			drop:function (event, ui) {
		
				var basket = $(this),
						move = ui.draggable,
						itemId = basket.find("ul li[data-id='" + move.attr("data-id") + "']");
		
				// To increase the value by +1 if the same item is already in the basket
				if (itemId.html() != null) {
					itemId.find("input").val(parseInt(itemId.find("input").val()) + 1);
				}
				else {
					// Add the dragged item to the basket
					addBasket(basket, move);
		
					// Updating the quantity by +1" rather than adding it to the basket
					move.find("input").val(parseInt(move.find("input").val()) + 1);
				}
			}
		});

        // This function runs onc ean item is added to the basket
        function addBasket(basket, move) {
			basket.find("ul").append('<li data-id="' + move.attr("data-id") + '">'
					+ '<span class="name">' + move.find("h3").html() + '</span>'
					+ '<button class="delete">&#10005;</button>');
		}


        // The function that is triggered once delete button is pressed
        $(".basket ul li button.delete").live("click", function () {
			$(this).closest("li").remove();
		});

    });


    $(function(){
        $(".fav-button").on("click",function(){

            try{
                $(this).attr('disabled',true);

                var ShoeToAdd = $(this).closest("p").attr("id");

                var myFavouriteShoe =JSON.parse(localStorage.getItem("favShoe"));

                if(myFavouriteShoe ==null){
                    myFavouriteShoe = [];
                }

                if(myFavouriteShoe !==null){
                    for(var j=0;j<myFavouriteShoe.length;j++){
                        if(ShoeToAdd==myFavouriteShoe[j]){
                            alert("This Shoe is already in your favourites");
                            myFavouriteShoe =[];
                        }
                    }
                }

                myFavouriteShoe.push(ShoeToAdd);

                localStorage.setItem("favShoe",JSON.stringify(myFavouriteShoe));

            }
            catch(e){
                if(e==QUOTA_EXCEEDED_ERR){
                    console.log("Error: Local storage limit exceeds");
                }
                else{
                    console.log("Error:Saving to local storage");
                }
            }
        });
    });



    $(function(){
        $(".remove-button").on("click",function(){

                $(this).attr('disabled',true);

                var ShoeToRemove = $(this).closest("p").attr("id");

                var myFavouriteShoe =JSON.parse(localStorage.getItem("favShoe"));

                if(myFavouriteShoe !==null){
                    for(var j=0;j<myFavouriteShoe.length;j++){
                        if(ShoeToRemove==myFavouriteShoe[j]){
                            alert("This shoe has been removed");
                            delete myFavouriteShoe[j];
                            localStorage.setItem("favShoe",JSON.stringify(myFavouriteShoe));
                            myFavouriteShoe[j]=[];
                        }
                    }    
                }
                if(myFavouriteShoe ==null){
                    alert("You have no favourite items");
                }   
                
            });
        });

</script>

</body>
</html>